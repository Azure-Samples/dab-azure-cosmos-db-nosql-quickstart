@page "/"
@attribute [StreamRendering]

<PageTitle>
    Data API builder - Azure Cosmos DB for NoSQL Dashboard
</PageTitle>

<main class="flex flex-row gap-4 justify-start items-stretch h-screen bg-white font-sans">
    <nav class="basis-1/5 bg-zinc-100">
        <Menu />
    </nav>
    <article class="basis-4/5 overflow-y-auto">
        @if(IsLoading)
        {
            <Loading />
        }
        else if (Products.Count > 0)
        {
            <Summary NumberOfItems="@(Products.Count)" AveragePrice="@(Products.Average(p => p.ListPrice))" MostRecentRelease="@(Products.Max(p => p.SellStartDate))" />
            <Table Products="@Products" />
        }
        else {
            <div class="flex justify-center items-center h-full">
                <span class="prose prose-xl text-gray-500">
                    No products found
                </span>
            </div>
        }
    </article>
</main>

@code {
    private Random Random { get; } = new Random();
    private List<Product> Products { get; } = [];
    private bool IsLoading { get; set; } = true;

    protected override async Task OnInitializedAsync()
    {
        // TODO: Get products from API

        IsLoading = false;
    }
}